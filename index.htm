<!DOCTYPE html> 
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ³¨éŸ³çŒœçŒœæ¨‚</title>
  <style>
    body { font-family:"Noto Sans TC",sans-serif; text-align:center; padding:30px; background:#f4f4f4; }
    h1 { font-size:2rem; margin-bottom:1rem; }
    #keyboard { display:flex; flex-wrap:wrap; justify-content:center; max-width:500px; margin:0 auto; gap:8px; }
    .key { font-size:1.5rem; padding:10px 14px; border:none; border-radius:8px; background:#fff; box-shadow:0 1px 4px rgba(0,0,0,.2); cursor:pointer; transition:.2s; }
    .key.correct { background:#4caf50; color:#fff; }
    .key.incorrect { background:#ccc; color:#fff; }
    .key:disabled { cursor:not-allowed; }
    #result { margin-top:30px; font-size:1.25rem; }
    #restartBtn,#shareBtn { margin-top:15px; padding:8px 16px; font-size:1rem; border:none; border-radius:6px; cursor:pointer; }
    #restartBtn { background:#2196f3; color:#fff; }
    #shareBtn { background:#4caf50; color:#fff; display:none; }
    #popup { display:none; position:fixed; bottom:30px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,.8); color:#fff; padding:10px 20px; border-radius:5px; font-size:1rem; }
  </style>
</head>
<body>
  <h1>æ³¨éŸ³çŒœçŒœæ¨‚</h1>
  <div id="keyboard"></div>
  <div id="result"></div>
  <button id="restartBtn">é‡æ–°é–‹å§‹</button>
  <button id="shareBtn">åˆ†äº«æˆ°ç¸¾</button>
  <div id="popup">å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼</div>

  <script>
  // è‡ªå‹•æ¸…æ‰ç¶²å€åƒæ•¸ï¼ˆä¾‹å¦‚ fbclidï¼‰
  if (location.search.length > 0) {
    history.replaceState({}, document.title, location.origin + location.pathname);
  }

  // å…¨éƒ¨åŒ…åœ¨ IIFEï¼Œé¿å…å¾ console ç›´æ¥å­˜å–åˆ°è®Šæ•¸
  (() => {
    const bopomofo = ["ã„…","ã„†","ã„‡","ã„ˆ","ã„‰","ã„Š","ã„‹","ã„Œ","ã„","ã„","ã„","ã„","ã„‘","ã„’","ã„“","ã„”","ã„•","ã„–","ã„—","ã„˜","ã„™","ã„§","ã„¨","ã„©","ã„š","ã„›","ã„œ","ã„","ã„","ã„Ÿ","ã„ ","ã„¡","ã„¢","ã„£","ã„¤","ã„¥","ã„¦"];

    let _a = "";                 // â† ç­”æ¡ˆï¼ˆä¸æš´éœ²åˆ°å…¨åŸŸï¼‰
    let _g = 0;                  // çŒœæ¸¬æ¬¡æ•¸
    const _m = bopomofo.length;  // æœ€å¤§æ¬¡æ•¸

    const kb = document.getElementById("keyboard");
    const rs = document.getElementById("result");
    const btnRestart = document.getElementById("restartBtn");
    const btnShare = document.getElementById("shareBtn");
    const tip = document.getElementById("popup");

    const pick = () => { _a = bopomofo[(Math.random() * bopomofo.length) | 0]; };

    const buildKeys = () => {
      kb.innerHTML = "";
      bopomofo.forEach(ch => {
        const b = document.createElement("button");
        b.textContent = ch;
        b.className = "key";
        b.addEventListener("click", () => guess(b, ch), { once:false });
        kb.appendChild(b);
      });
    };

    const disableAll = () => document.querySelectorAll(".key").forEach(b => b.disabled = true);

    const reset = () => {
      pick();
      buildKeys();
      rs.textContent = "";
      _g = 0;
      btnShare.style.display = "none";
    };

    const share = () => {
      const emoji = (_g > 0 ? ("â¬›\n").repeat(Math.max(0, _g - 1)) : "") + "ğŸŸ©";
      const fixedUrl = "https://bopomofo.langcheng.uk";
      const text = `æ³¨éŸ³çŒœçŒœæ¨‚\n${_g}/${_m}\n${emoji}\n${fixedUrl}`;

      if (navigator.clipboard && isSecureContext) {
        navigator.clipboard.writeText(text).then(() => {
          tip.style.display = "block"; setTimeout(()=> tip.style.display="none", 2000);
        }).catch(fallback);
      } else { fallback(); }

      function fallback(){
        const ta = document.createElement("textarea");
        ta.value = text; document.body.appendChild(ta);
        ta.select(); try { document.execCommand("copy"); tip.style.display = "block"; setTimeout(()=> tip.style.display="none", 2000); }
        catch(e){ alert("âŒ è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ã€‚"); }
        document.body.removeChild(ta);
      }
    };

    const guess = (btn, ch) => {
      _g++;
      if (ch === _a) {
        btn.classList.add("correct");
        rs.textContent = `ğŸ‰ æ­å–œä½ ç¬¬ ${_g} æ¬¡çŒœå°ï¼ç­”æ¡ˆæ˜¯ ${_a}`;
        disableAll();
        btnShare.style.display = "inline-block";
      } else {
        btn.classList.add("incorrect");
        btn.disabled = true;
        rs.textContent = `âŒ ${ch} éŒ¯èª¤ï¼Œç¹¼çºŒçŒœï¼ï¼ˆå·²çŒœ ${_g} æ¬¡ï¼‰`;
      }
    };

    
    btnRestart.addEventListener("click", reset);
    btnShare.addEventListener("click", share);

   
    reset();
//ä½ ç«Ÿç„¶é‚„çœ‹å®Œäº†
   
    Object.defineProperty(window, "answer", { get(){ return "ğŸ˜‰ åˆ¥å·çœ‹å•¦"; } }); 
  })();
  </script> 
</body>
</html>



